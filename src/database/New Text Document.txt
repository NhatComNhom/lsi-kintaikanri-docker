CREATE TABLE tbl_employees (
  id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(50) NOT NULL,
  username VARCHAR(50) NOT NULL,
  email VARCHAR(50) NOT NULL UNIQUE,
  password VARCHAR(50) NOT NULL,
  role TINYINT(1) NOT NULL DEFAULT 0
);

CREATE TABLE tbl_attendance (
  id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  employee_id INT(6) UNSIGNED NOT NULL,
  date DATE,
  check_in DATETIME,
  check_out DATETIME,
  break_start DATETIME,
  break_end DATETIME,
  location VARCHAR(255),
  FOREIGN KEY (employee_id) REFERENCES tbl_employees(id) ON DELETE CASCADE
);

ALTER TABLE tbl_employees CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci;
ALTER TABLE tbl_attendance CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci;

INSERT INTO `tbl_employee` (`id`, `name`, `username`, `email`, `password`, `role`) VALUES (NULL, 'admin', 'admin', 'admin@lsi-dev.co.jp', 'lsilsilsi', '1');
INSERT INTO `tbl_employee` (`id`, `name`, `username`, `email`, `password`, `role`) VALUES (NULL, 'ashi', 'A氏', 'ashi@lsi-dev.co.jp', 'ashi', '0');
INSERT INTO `tbl_employee` (`id`, `name`, `username`, `email`, `password`, `role`) VALUES (NULL, 'bshi', 'B氏', 'bshi@lsi-dev.co.jp', 'bshi', '0');



CREATE DATABASE IF NOT EXISTS attendance_system DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

USE attendance_system;

CREATE TABLE IF NOT EXISTS tbl_employees (
  id INT(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(50) NOT NULL,
  username VARCHAR(50) NOT NULL,
  email VARCHAR(50) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  role TINYINT(1) NOT NULL DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE IF NOT EXISTS tbl_location (
    location_id INT(11) NOT NULL AUTO_INCREMENT,
    latitude DECIMAL(10, 8) NOT NULL,
    longitude DECIMAL(11, 8) NOT NULL,
    PRIMARY KEY (location_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE IF NOT EXISTS tbl_checkinout (
    check_id INT(11) NOT NULL AUTO_INCREMENT,
    user_id INT(11) UNSIGNED NOT NULL,
    check_type ENUM('check_in', 'check_out','start_break', 'end_break'),
    check_time DATETIME,
    location_id INT(11),
    PRIMARY KEY (check_id),
    FOREIGN KEY (user_id) REFERENCES tbl_employees(id),
    FOREIGN KEY (location_id) REFERENCES tbl_location(location_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE utf8mb4_unicode_ci;

